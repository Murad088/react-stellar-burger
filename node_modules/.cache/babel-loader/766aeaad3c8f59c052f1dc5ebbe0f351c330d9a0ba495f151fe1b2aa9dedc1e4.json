{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u041C\\u0443\\u0440\\u0430\\u0434\\\\dev\\\\stellar-burgers\\\\src\\\\components\\\\burger-constructor\\\\burger-constructor.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport styles from \".//burger-constructor.module.css\";\nimport { ConstructorElement, DragIcon, CurrencyIcon, Button } from \"@ya.praktikum/react-developer-burger-ui-components\";\nimport PropTypes from \"prop-types\";\nimport { ingredientPropType } from \"../../utils/prop-types\";\nimport Modal from \"../modal/modal\";\nimport OrderDetails from \"../order-details/order-details\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const BurgerConstructor = _ref => {\n  _s();\n  var _order$bun;\n  let {\n    order,\n    setOrder,\n    element\n  } = _ref;\n  const [show, setShow] = useState(false);\n  const bunsPrice = ((_order$bun = order.bun) === null || _order$bun === void 0 ? void 0 : _order$bun.price) || 0;\n  const ingredientPrice = order.ingredients.map(ingredient => ingredient.price * ingredient.qty).reduce((prev, current) => {\n    return prev + current;\n  }, 0);\n  const total = ingredientPrice + bunsPrice;\n  const handleClose = element => {\n    setOrder(prevOrder => {\n      const type = element.type === \"bun\" ? \"bun\" : \"ingredients\";\n      const newState = {\n        ...prevOrder\n      };\n      if (newState[type].some(stateIngredient => stateIngredient._id === element._id)) {\n        newState[type] = newState[type].map(stateIngredient => {\n          if (stateIngredient._id === element._id) {\n            return {\n              ...stateIngredient,\n              qty: stateIngredient.qty--\n            };\n          }\n          return stateIngredient;\n        });\n      } else {\n        newState[type].push({\n          ...element,\n          qty: 1\n        });\n      }\n      return newState;\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.column,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.container,\n      children: [order.bun ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.bun,\n        children: /*#__PURE__*/_jsxDEV(ConstructorElement, {\n          type: \"top\",\n          isLocked: true,\n          text: `${order.bun.name} (верх)`,\n          price: order.bun.price,\n          thumbnail: order.bun.image\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 13\n        }, this)\n      }, `${order.bun.id}-top`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 11\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.scrolling,\n        children: order.ingredients.map(element => {\n          return Array(element.qty).fill(element).map((el, index) => {\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.listItem,\n              children: [/*#__PURE__*/_jsxDEV(DragIcon, {\n                type: \"primary\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 79,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-full\",\n                children: /*#__PURE__*/_jsxDEV(ConstructorElement, {\n                  text: `${element.name} (низ)`,\n                  price: element.price,\n                  thumbnail: element.image,\n                  handleClose: () => {\n                    handleClose(element);\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 81,\n                  columnNumber: 23\n                }, this)\n              }, element.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 80,\n                columnNumber: 21\n              }, this)]\n            }, `${element.id}-${index}`, true, {\n              fileName: _jsxFileName,\n              lineNumber: 75,\n              columnNumber: 19\n            }, this);\n          });\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), order.bun ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.bun,\n        children: /*#__PURE__*/_jsxDEV(ConstructorElement, {\n          type: \"bottom\",\n          isLocked: true,\n          text: `${order.bun.name} (низ)`,\n          price: order.bun.price,\n          thumbnail: order.bun.image\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 13\n        }, this)\n      }, `${order.bun.id}-bottom`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `${styles.currency}  `,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `${styles.order_button} `,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: `${styles.currencyText} text text_type_digits-medium `,\n          children: [total, /*#__PURE__*/_jsxDEV(CurrencyIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          size: \"large\",\n          htmlType: \"button\",\n          onClick: () => setShow(true),\n          children: \"\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this), show && /*#__PURE__*/_jsxDEV(Modal, {\n          title: \"\",\n          onClose: () => setShow(false),\n          children: /*#__PURE__*/_jsxDEV(OrderDetails, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n};\n_s(BurgerConstructor, \"NKb1ZOdhT+qUsWLXSgjSS2bk2C4=\");\n_c = BurgerConstructor;\nBurgerConstructor.propTypes = {\n  data: PropTypes.arrayOf(ingredientPropType.isRequired).isRequired\n};\nvar _c;\n$RefreshReg$(_c, \"BurgerConstructor\");","map":{"version":3,"names":["React","useState","styles","ConstructorElement","DragIcon","CurrencyIcon","Button","PropTypes","ingredientPropType","Modal","OrderDetails","jsxDEV","_jsxDEV","BurgerConstructor","_ref","_s","_order$bun","order","setOrder","element","show","setShow","bunsPrice","bun","price","ingredientPrice","ingredients","map","ingredient","qty","reduce","prev","current","total","handleClose","prevOrder","type","newState","some","stateIngredient","_id","push","className","column","children","container","isLocked","text","name","thumbnail","image","fileName","_jsxFileName","lineNumber","columnNumber","id","scrolling","Array","fill","el","index","listItem","currency","order_button","currencyText","size","htmlType","onClick","title","onClose","_c","propTypes","data","arrayOf","isRequired","$RefreshReg$"],"sources":["C:/Users/Мурад/dev/stellar-burgers/src/components/burger-constructor/burger-constructor.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport styles from \".//burger-constructor.module.css\";\r\nimport {\r\n  ConstructorElement,\r\n  DragIcon,\r\n  CurrencyIcon,\r\n  Button,\r\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport PropTypes from \"prop-types\";\r\nimport { ingredientPropType } from \"../../utils/prop-types\";\r\nimport Modal from \"../modal/modal\";\r\nimport OrderDetails from \"../order-details/order-details\";\r\n\r\nexport const BurgerConstructor = ({ order, setOrder, element }) => {\r\n  const [show, setShow] = useState(false);\r\n  const bunsPrice = order.bun?.price || 0;\r\n  const ingredientPrice = order.ingredients\r\n    .map((ingredient) => ingredient.price * ingredient.qty)\r\n    .reduce((prev, current) => {\r\n      return prev + current;\r\n    }, 0);\r\n\r\n  const total = ingredientPrice + bunsPrice;\r\n\r\n  const handleClose = (element) => {\r\n    setOrder((prevOrder) => {\r\n      const type = element.type === \"bun\" ? \"bun\" : \"ingredients\";\r\n\r\n      const newState = { ...prevOrder };\r\n\r\n      if (\r\n        newState[type].some(\r\n          (stateIngredient) => stateIngredient._id === element._id\r\n        )\r\n      ) {\r\n        newState[type] = newState[type].map((stateIngredient) => {\r\n          if (stateIngredient._id === element._id) {\r\n            return {\r\n              ...stateIngredient,\r\n              qty: stateIngredient.qty--,\r\n            };\r\n          }\r\n\r\n          return stateIngredient;\r\n        });\r\n      } else {\r\n        newState[type].push({ ...element, qty: 1 });\r\n      }\r\n\r\n      return newState;\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className={styles.column}>\r\n      <div className={styles.container}>\r\n        {order.bun ? (\r\n          <div key={`${order.bun.id}-top`} className={styles.bun}>\r\n            <ConstructorElement\r\n              type=\"top\"\r\n              isLocked={true}\r\n              text={`${order.bun.name} (верх)`}\r\n              price={order.bun.price}\r\n              thumbnail={order.bun.image}\r\n            />\r\n          </div>\r\n        ) : null}\r\n\r\n        <div className={styles.scrolling}>\r\n          {order.ingredients.map((element) => {\r\n            return Array(element.qty)\r\n              .fill(element)\r\n              .map((el, index) => {\r\n                return (\r\n                  <div\r\n                    key={`${element.id}-${index}`}\r\n                    className={styles.listItem}\r\n                  >\r\n                    <DragIcon type=\"primary\" />\r\n                    <div key={element.id} className=\"w-full\">\r\n                      <ConstructorElement\r\n                        text={`${element.name} (низ)`}\r\n                        price={element.price}\r\n                        thumbnail={element.image}\r\n                        handleClose={() => {\r\n                          handleClose(element);\r\n                        }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                );\r\n              });\r\n          })}\r\n        </div>\r\n\r\n        {order.bun ? (\r\n          <div key={`${order.bun.id}-bottom`} className={styles.bun}>\r\n            <ConstructorElement\r\n              type=\"bottom\"\r\n              isLocked={true}\r\n              text={`${order.bun.name} (низ)`}\r\n              price={order.bun.price}\r\n              thumbnail={order.bun.image}\r\n            />\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n      <div className={`${styles.currency}  `}>\r\n        <div className={`${styles.order_button} `}>\r\n          <span\r\n            className={`${styles.currencyText} text text_type_digits-medium `}\r\n          >\r\n            {total}\r\n            <CurrencyIcon />\r\n          </span>\r\n          <Button\r\n            type=\"primary\"\r\n            size=\"large\"\r\n            htmlType=\"button\"\r\n            onClick={() => setShow(true)}\r\n          >\r\n            Оформить заказ\r\n          </Button>\r\n          {show && (\r\n            <Modal title=\"\" onClose={() => setShow(false)}>\r\n              <OrderDetails />\r\n            </Modal>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nBurgerConstructor.propTypes = {\r\n  data: PropTypes.arrayOf(ingredientPropType.isRequired).isRequired,\r\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}